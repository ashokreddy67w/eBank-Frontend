<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Signup Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
     <link rel="stylesheet" href="Loginsingup.css"> 
   <style>

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Arial', sans-serif;
}

body {
    background: linear-gradient(45deg, #7c0b0b, #5b9c97, #3f8392, #8d7736);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    
}

@keyframes gradientBG {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
}

.navbar {
    display: flex;
    justify-content: center;
    background: rgba(255,255,255,0.2);
    padding: 15px 0;
    width: 100%;
    
}

.navbar a {
    text-align: center;
    color: white;
    text-decoration: none;
    margin: 0 30px;
    font-size: 18px;
    transition: color 0.3s ease;
}

.navbar a:hover {
    color: #ffeb3b;
}

.login-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
    gap: 50px;
    padding: 50px;
    
}

.login-option {
    background: rgba(255,255,255,0.9);
    border-radius: 15px;
    padding: 30px;
    text-align: center;
    width: 300px;
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    background-color: rgb(189, 181, 168);
}

.login-option:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.login-option h2 {
    margin-bottom: 20px;
    color: #333;
}

.login-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 1000;
    
}

.form-container {
    max-height: 90%;
    overflow-y: auto;
}

.login-form, .signup-form {
    background: white;
    border-radius: 15px;
    padding: 40px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    transition: transform 0.5s ease;
    margin-top: 30px;
    margin-bottom: 30px; 
}

.login-modal.active {
    display: flex;
}

.login-modal.active .login-form,
.login-modal.active .signup-form {
    transform: translateY(0);
    /* background-color: rgb(190, 211, 208); */
}

.login-form input, .signup-form input {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
}

.login-form button, .signup-form button {
    width: 100%;
    padding: 10px;
    background: #4ecdc4;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s ease;
}

.login-form button:hover, .signup-form button:hover {
    background: #45b7d1;
}

.close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 30px;
    color: white;
    cursor: pointer;
}

.switch-form {
    margin-top: 15px;
    color: #4ecdc4;
    cursor: pointer;
    text-decoration: underline;
}

.gender-options {
    margin-top: 10px;
    text-align: left;
    
}

.gender-options label {
    display: inline-block;
    margin-right: 10px;
    
}


.radio-buttons {
    display: flex;
    gap: 20px;
    justify-content: flex-start;
}

.radio-buttons label {
    display: flex;
    align-items: center;
    gap: 5px;
}

.radio-buttons input[type="radio"] {
    margin-right: 5px;
}
.error{
    font-size: 10px;
    margin-top: -10px;
}
.fa-user{
    position: relative;
    left: 820px;
    font-size: 30px;
    color: white;
    

}
.fa-arrow-left{
    position: relative;
   right: 400px;
    font-size: 30px;
    color: white;
    
}


   </style>

    
</head>
<body>
    
    <nav class="navbar">
        
       <a href="index.html"> <i class="fa-solid fa-arrow-left"></i></a>
           <a href="adminlogin.html"> <i class="fas fa-user"></i></a>
          
        <a href="index.html">Home</a>
        <a href="#">About Us</a>
        <a href="#">Contact Us</a>
       
    </nav>

   
    <div class="login-container">
        <div class="login-option user-login">
            <h2>User Login/Signup</h2>
            <p>Click to access user account</p>
        </div>
        
    </div>
    
    <div class="login-modal user-login-modal">
        <span class="close-btn">&times;</span>
        <div class="form-container">
            <form class="login-form user-login-form" action="userfunctionlity.html"  >
                <!-- onsubmit="return validateForm()" -->
                <!-- action="userfunctionlity.html" -->
                <h2>User Login</h2>
                <input type="email" placeholder="Email" required>
                <div id="Userloginerror" class="error" style="color: red;"></div>
                <input type="password" placeholder="Password" required>
                <div id="userloginpassword" class="error" style="color: red;"></div>
                <button type="submit">Login</button>
                <div class="switch-form user-switch-form">Don't have an account? Sign up</div>
            </form>

            <form class="signup-form user-signup-form" style="display:none;"  >
                <!-- onsubmit="return check()"  -->
                <h2>User Signup</h2>
                <input type="text" placeholder="Full Name"  required>
                <div id="nameError" class="error" style="color: red;"></div>

                <input type="email" placeholder="Emailid"  required>
                <div id="emailError" class="error" style="color: red;"></div>

                <!-- <input type="password" placeholder="Password" required> -->
                <input type="text" placeholder="Phonenumber"  required maxlength="10">
                <div id="PhonenumberError" class="error" style="color: red;"></div>

                <input type="text" placeholder="Aadhar number"  required maxlength="12">
                <div id="AadharError" class="error" style="color: red;"></div>

                <input type="text" placeholder="Panumber" required maxlength="10">
                <div id="pannumberError" class="error" style="color: red;"></div>

                <input type="text" placeholder="Address"  required>
                <div id="AddressError" class="error" style="color: red;"></div>


                <div class="gender-options">
                    <label for="gender">Gender:</label>
                    <div class="radio-buttons">
                        <label for="male">
                            <input type="radio" id="male" name="gender" value="male"  required>
                            Male
                        </label>
                        <label for="female">
                            <input type="radio" id="female" name="gender" value="female" required>
                            Female
                        </label>
                    </div>
                </div>
                <input type="date" placeholder="Choose Date of Birth" id="Dateofbirth" required >
                <input type="number" placeholder="Enter Your Amount" id="Amount" required>
                <div id="AmountError" class="error" style="color: red;"></div>

                <button type="submit">Sign Up</button>
                <div class="switch-form user-login-switch">Already have an account? Login</div>
            </form>
        </div>
    </div>

   
    <script >
        

const userLoginOption = document.querySelector('.user-login');
const userLoginModal = document.querySelector('.user-login-modal');
const userCloseBtn = userLoginModal.querySelector('.close-btn');
const userLoginForm = userLoginModal.querySelector('.user-login-form');
const userSignupForm = userLoginModal.querySelector('.user-signup-form');
const userSwitchToSignup = userLoginModal.querySelector('.user-switch-form');
const userSwitchToLogin = userLoginModal.querySelector('.user-login-switch');

userLoginOption.addEventListener('click', () => {
    userLoginModal.classList.add('active');
});

userCloseBtn.addEventListener('click', () => {
    userLoginModal.classList.remove('active');
});

userSwitchToSignup.addEventListener('click', () => {
    userLoginForm.style.display = 'none';
    userSignupForm.style.display = 'block';
});

userSwitchToLogin.addEventListener('click', () => {
    userLoginForm.style.display = 'block';
    userSignupForm.style.display = 'none';
});



// user restration
document.querySelector('.user-signup-form').addEventListener('submit', function (event) {
    event.preventDefault(); 
    const errorElements = document.querySelectorAll('.error');
     errorElements.forEach(el => el.textContent = '');
     let isValid = true;
  fetch("http://localhost:9090/alluserdetails",{
         mathod:'GET',
         headers:{ 
           'Content-Type': 'application/json',
          }
        }).then((response)=> response.json())
        .then((data)=>{
            
            const users = Array.isArray(data) ? data : (data.data || data.content || data.users || []);     
     const name = document.querySelector('input[placeholder="Full Name"]').value;
    
     if (name.trim().length < 2) {
        document.getElementById('nameError').textContent = 'Name must be at least 2 characters long';
        isValid = false;
     }

     const isemailid = document.querySelector('input[placeholder="Emailid"]').value;
     
     if (!/^[a-zA-Z0-9._%+-]+@gmail\.com$/.test(isemailid)) {
        document.getElementById('emailError').textContent = 'Please enter a valid email address';
         isValid = false;
     }
     //  checking emailid already used
     const isEmalidUsed = users.some((user) => user.emailid === isemailid);
     if(isEmalidUsed ===true) {
     document.getElementById('emailError').textContent = 'emailid already used';
     isValid = false;
     }
     const dataaadharnumber = document.querySelector('input[placeholder="Aadhar number"]').value;
     if (!/^\d{12}$/.test(dataaadharnumber)) {
        document.getElementById('AadharError').textContent = 'Aadhar number must be 12 digits';
        isValid = false;
     }
     //  checking aadharnumber already used
     const isAadharUsed = users.some((user) => user.aadharnumber == dataaadharnumber);
     if(isAadharUsed ===true) {
     document.getElementById('AadharError').textContent = 'Aadhar already used';
     isValid = false;
     }
    
     const isphoneNumber = document.querySelector('input[placeholder="Phonenumber"]').value;
     if (!/^[6-9]\d{9}$/.test(isphoneNumber)) {
        document.getElementById('PhonenumberError').textContent = 'Mobile number must be 10 digits starting with 6-9';
        isValid = false;
     }
     //  checking phonenumber already used
     const isphoneNumberUsed = users.some((user) => user.phonenumber == isphoneNumber);
     if(isphoneNumberUsed ===true) {
     document.getElementById('PhonenumberError').textContent = 'Phone number already used';
     isValid = false;
     }

    
     const pan = document.querySelector('input[placeholder="Panumber"]').value;
     if (!/^[A-Z]{5}\d{4}[A-Z]{1}$/.test(pan)) {
        document.getElementById('pannumberError').textContent = 'Invalid PAN number format';
        isValid = false;
     }
     //  checking pannumber already used
     const ispanUsed = users.some((user) => user.panumber === pan);
     if(ispanUsed ===true) {
     document.getElementById('pannumberError').textContent = 'pan number already used';
     isValid = false;
     }

    
     const address = document.querySelector('input[placeholder="Address"]').value;
     if (address.trim().length < 8) {
        document.getElementById('AddressError').textContent = 'Address must be at least 8 characters long';
        isValid = false;
     }

    
    const amount = document.querySelector('input[placeholder="Enter Your Amount"]').value;
    if (isNaN(amount) || Number(amount) <= 1000) {
        document.getElementById('AmountError').textContent = 'Minimum Deposit is 1000 Rupes';
        isValid = false;
    }

    // const dateInput =


// const today = new Date();
// const maxDate = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate());


// dateInput.max = maxDate.toISOString().split("T")[0];

    if (!isValid) {
        return; 
    }
    
    const userDate = {
        name: name,
        emailid: isemailid,
        phonenumber: isphoneNumber,
        aadharnumber: dataaadharnumber,
        panumber: pan,
        address: address,
        gender: document.querySelector('input[name="gender"]:checked').value,
        dateofbirth: document.querySelector('input[placeholder="Choose Date of Birth"]').value ,
        amount: amount,
    };
    fetch('http://localhost:9090/userregistration', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(userDate),
    })
        .then((response) => response.json())
        .then((data) => {
            if (data.httstatuscode === 200) {
                alert('Registration successful!');
                document.querySelector('.user-signup-form').reset();

            } else {
                alert('Registration failed. Please try again.');
                
            }
        })
        .catch((error) => {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    });
});


document.querySelector('.user-login-form').addEventListener('submit', function (event) {
    event.preventDefault();

    const errorElements = document.querySelectorAll('.error');
    errorElements.forEach(el => el.textContent = '');
    let isValid = true;


    fetch("http://localhost:9090/alluserdetails",{
        mathod:'GET',
        headers:{ 
         'Content-Type': 'application/json',
        }
        }).then((response)=> response.json())
        .then((data)=>{
            localStorage.setItem("AlluserDetails", JSON.stringify(data));
          const Userlog = Array.isArray(data) ? data : (data.data || data.content || data.users || []);
        
          

  const  emailid= document.querySelector('input[placeholder="Email"]').value;
    const isEmalidUsed = Userlog.some((user) => user.emailid === emailid);
    if(isEmalidUsed ===false) {
    document.getElementById('Userloginerror').textContent = 'Invalid emalid';
    isValid = false;
     }

   const pin=document.querySelector('input[placeholder="Password"]').value;
   const isUserpassword = Userlog.some((user) => user.pin == pin);
   if(isUserpassword ===false) {
   document.getElementById('userloginpassword').textContent = 'Invalid Password';
   isValid = false;
    }
    
    if (!isValid) {
        return; 
         }
 
   fetch(`http://localhost:9090/userlogin/${encodeURIComponent(emailid)}/${encodeURIComponent(pin)}`,{
        method: 'GET',
        headers: {
            'content-Type': 'application/json'
        }  

    }).then(response=>response.json())
    .then(data=>{
        console.log(data);
        try {
           
            if(data.httstatuscode===200){
              window.location.href="userfunctionlity.html";
              localStorage.setItem("userloginDetails", JSON.stringify(data));
             
            }
        } catch (error) {
            console.log("error");
            
        }   
    });
});
}); 




    </script>
        

</body>
</html>


